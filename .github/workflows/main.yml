name: Compress Code

on:
  workflow_dispatch:

jobs:
  compress-code:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
          
      - run: git config user.email "${{ github.actor }}@users.noreply.github.com"
        if: ${{ github.repository_owner != 'github-actions' }}

      - run: git config user.name "${{ github.actor }}"
        if: ${{ github.repository_owner != 'github-actions' }}
      
      - name: Remove .github folder
        run: rm -rf .github
      
      - name: Compress code and create zip
        run: |
          git archive --output=v1.19.4-0.9.x-unknown.zip HEAD .
      
      - uses: actions/upload-artifact@v2
        with:
          name: v1.19.4-0.9.x-unknown
          path: ./v1.19.4-0.9.x-unknown.zip
